**Numerical Analysis MATH50003 (2024â€“25) Problem Sheet 8**



**Problem 1** Give explicit formulae for $\hat f_k$ and $\hat f_k^n$ for the following functions:
$$
\cos Î¸, \cos 4Î¸, \sin^4Î¸, {3 \over 3 - {\rm e}^{\rm i Î¸}}, {1 \over 1 - 2{\rm e}^{\rm i Î¸}}
$$

**SOLUTION**

(1) Just expand in complex exponentials to find that
$$
\cos Î¸ = {\exp({\rm i} Î¸) + \exp(-{\rm i} Î¸) \over 2}
$$
that is $\hat f_1 = \hat f_{-1} = 1/2$, $\hat f_k = 0$ otherwise.
Therefore for $pâˆˆ â„¤$ we have
$$
\begin{align*}
\hat f_k^1 &= \hat f_1 + \hat f_{-1} = 1 \\
\hat f_{2p}^2 &= 0, \hat f_{2p+1}^2 = \hat f_1 + \hat f_{-1} = 1 \\
\hat f_{1+np}^n &= \hat f_{-1+np}^n = 1/2, \hat f_k^n = 0
\end{align*}
$$
for $n = 3,4,â€¦$.

(2) Similarly
$$
\cos 4 Î¸ = {\exp(4{\rm i} Î¸) + \exp(-4{\rm i} Î¸) \over 2}
$$
that is $\hat f_4 = \hat f_{-4} = 1/2$, $\hat f_k = 0$ otherwise.
Therefore for $pâˆˆ â„¤$ we have
$$
\begin{align*}
\hat f_p^1 &= \hat f_4 + \hat f_{-4} = 1 \\
\hat f_{2p}^2 &= \hat f_4 + \hat f_{-4} = 1, \hat f_{2p+1}^2 = 0 \\
\hat f_{3p}^3 &= 0, \hat f_{3pÂ±1}^3 = \hat f_{Â±4} =1/2 \\
\hat f_{4p}^4 &= \hat f_{-4} + \hat f_4 = 1, \hat f_{4pÂ±1}^4 = 0,  \hat f_{4p+2}^4 = 0 \\
\hat f_{5p}^5 &= 0, \hat f_{5p+1}^5 = \hat f_{-4} = 1/2, \hat f_{5p-1}^5 = \hat f_{4} = 1/2,  \hat f_{5pÂ±2}^5 =0  \\
\hat f_{6p}^6 &=0, \hat f_{6pÂ±1}^6 = 0,  \hat f_{6p+2}^6 = \hat f_{-4} = 1/2,  \hat f_{6p-2}^6 = \hat f_{4} = 1/2, \hat f_{6p+3}^6 =0  \\
\hat f_{7p}^7 &= 0, \hat f_{7pÂ±1}^7 = 0,  \hat f_{7pÂ±2}^7 = 0, \hat f_{7pÂ±3}^7 = \hat f_{âˆ“4} = 1/2 \\
\hat f_{8p}^8 &= \hat f_{8pÂ±1}^8 = \hat f_{8pÂ±2}^8 =  \hat f_{8pÂ±3}^8 = 0, \hat f_{8p+4}^8 = \hat f_4 + \hat f_{-4} = 1 \\
\hat f_{k+pn}^n &= \hat f_k \hbox{ for $-4 â‰¤ k â‰¤ 4$, 0 otherwise}.
\end{align*}
$$

(3) Here we have:
$$
\meeq{
(\sin Î¸)^4= \left({\exp({\rm i} Î¸) - \exp(-{\rm i} Î¸) \over 2 {\rm i}}\right)^4
= \left({\exp(2{\rm i} Î¸) -2 + \exp(-2{\rm i} Î¸) \over -4}\right)^2 \ccr
= {\exp(4{\rm i} Î¸) -4\exp(2{\rm i} Î¸) +6 -4 \exp(-2{\rm i} Î¸)+\exp(-4{\rm i} Î¸) \over 16}
}
$$
that is $\hat f_{-4} = \hat f_4 = 1/16$, $\hat f_{-2} = \hat f_2 = -1/4$, $f_0 = 3/8$, $\hat f_k = 0$ otherwise.
Therefore for $pâˆˆ â„¤$ we have
$$
\begin{align*}
\hat f_p^1 &=\hat f_{-4} + \hat f_{-2} + \hat f_0 + \hat f_2 +  \hat f_4 = 0 \\
\hat f_k^2 &= 0 \\
\hat f_{3p}^3 &= \hat f_0 = 3/8, \hat f_{3p+1}^3 = \hat f_{-2} + \hat f_4 =-3/16,  \hat f_{3p-1}^3 = \hat f_{2} + \hat f_{-4} =-3/16 \\
\hat f_{4p}^4 &= \hat f_0 + \hat f_{-4} + \hat f_4 = 1/2, \hat f_{4pÂ±1}^4 = 0,  \hat f_{4p+2}^4 = \hat f_{2} + \hat f_{-2} =-1/2 \\
\hat f_{5p}^5 &= \hat f_0 = 3/8, \hat f_{5p+1}^5 = \hat f_{-4} = 1/16, \hat f_{5p-1}^5 = \hat f_{4} = 1/16,  \hat f_{5p+2}^5 = \hat f_2 = -1/4, \hat f_{5p-2}^5 = \hat f_{-2} = -1/4  \\
\hat f_{6p}^6 &= \hat f_0 = 3/8, \hat f_{6pÂ±1}^6 = 0,  \hat f_{6p+2}^6 = \hat f_2 + \hat f_{-4} = -3/16,  \hat f_{6p-2}^6 = \hat f_{-2} + \hat f_{4} = -3/16, \hat f_{6p+3}^6 =0  \\
\hat f_{7p}^7 &= \hat f_0 = 3/8, \hat f_{7pÂ±1}^7 = 0,  \hat f_{7pÂ±2}^7 = \hat f_{Â±2} = -1/4, \hat f_{7pÂ±3}^7 = \hat f_{âˆ“4} = 1/16 \\
\hat f_{8p}^8 &= \hat f_0 = 3/8, \hat f_{8pÂ±1}^8 = 0,  \hat f_{8pÂ±2}^8 = \hat f_{Â±2} = -1/4, \hat f_{8pÂ±3}^8 = 0, \hat f_{8p+4}^8 = \hat f_4 + \hat f_{-4} = 1/8 \\
\hat f_{k+pn}^n &= \hat f_k \hbox{ for $-4 â‰¤ k â‰¤ 4$, 0 otherwise}.
\end{align*}
$$

(4) Under the change of variables $z = {\rm e}^{{\rm i}Î¸}$ we can use Geoemtric series to determine
$$
{3 \over 3 - z} = {1 \over 1- z/3} = âˆ‘_{k=0}^âˆž {z^k \over 3^k}
$$
That is $\hat f_k = 1/3^k$ for $k â‰¥ 0$, and $\hat f_k = 0$ otherwise.
We then have for $0 â‰¤ k â‰¤ n-1$
$$
\hat f_{k+pn}^n = âˆ‘_{â„“=0}^âˆž {1 \over 3^{k+â„“n}} = {1 \over 3^k} {1 \over 1 - 1/3^n} = {3^n \over 3^{n+k} - 3^k}
$$

(5) Now make the change of variables $z = {\rm e}^{-{\rm i} Î¸}$ to get:
$$
{1 \over 1 - 2/z} = {1 \over -2/z} {1 \over 1 - z/2} = {1 \over -2/z} âˆ‘_{k=0}^âˆž {z^k \over 2^k}
= - âˆ‘_{k=1}^âˆž {{\rm e}^{-{\rm i} k Î¸} \over 2^k}
$$
That is $\hat f_k = -1/2^{-k}$ for $k â‰¤ -1$ and 0 otherwise.
We then have for $-n â‰¤ k â‰¤ -1$
$$
\hat f_{k+pn}^n =- âˆ‘_{â„“=0}^âˆž {1 \over 2^{-k+â„“n}} = -{1 \over 2^{-k}} {1 \over 1 - 1/2^n} = -{2^{n+k} \over 2^n - 1}
$$

**END**


**Problem 2** Prove that if the first $Î»-1$ derivatives $f(Î¸), f'(Î¸), â€¦, f^{(Î»-1)}(Î¸)$
are 2Ï€-periodic and $f^{(Î»)}$ is uniformly bounded  that
$$
|\hat f_k| = O(|k|^{-Î»})\qquad \hbox{as $|k| â†’ âˆž$}
$$
Use this to show for the Taylor case ($0 = \hat f_{-1} = \hat f_{-2} = â‹¯$) that
$$
|f(Î¸) - âˆ‘_{k=0}^{n-1} \hat f_k {\rm e}^{{\rm i}kÎ¸}| = O(n^{1-Î»})\qquad \hbox{as $n â†’ âˆž$}
$$

**SOLUTION**
A straightforward application of integration by parts yields the result
$$
\hat f_k = \frac{1}{2Ï€} \int^{2Ï€}_{0} f(Î¸) {\rm e}^{-ikÎ¸} dÎ¸ = \frac{(-i)^Î»}{2Ï€ k^{Î»}} \int^{2Ï€}_{0} f^{(Î»)}(Î¸) {\rm e}^{-ikÎ¸} dÎ¸
$$
given that $f^{(Î»)}$ is uniformly bounded, the second part follows directly from this result
$$
|âˆ‘_{k=n}^{âˆž} \hat f_k {\rm e}^{{\rm i}kÎ¸}| â‰¤ âˆ‘_{k=n}^{âˆž} |\hat f_k | â‰¤ C âˆ‘_{k=n}^{âˆž} k^{-Î»}
$$
for some constant $C$. The result then follows by the dominant convergence test:
$$
âˆ‘_{k=n}^{âˆž} k^{-Î»} â‰¤ \int_{n-1}^âˆž k^{-Î»} {\rm d}k = O(n^{1-Î»}).
$$

**END**


**Problem 3(a)**
If $f$ is a trigonometric polynomial  ($\hat f_k = 0$ for $|k| > m$) show
for $n â‰¥ 2m+1$ that we can exactly recover $f$:
$$
f(Î¸) = âˆ‘_{k=-m}^m \hat f_k^n {\rm e}^{{\rm i} k Î¸}
$$

**SOLUTION**
This follows from
$$
\hat f_k^n = âˆ‘_{p=-âˆž}^âˆž \hat f_{k+pn} = \hat f_k
$$
if $-m â‰¤ k â‰¤ m$ as if $p > 0$ we have $k + p n â‰¥ k + 2m+1 â‰¥ m+1$ hence
$\hat f_{k+pn} = 0$ and if $k < 0$ we have $k - pn â‰¤ k -2m-1 â‰¤ -m-1$ hence
$\hat f_{k+pn} = 0$.

**END**

**Problem 3(b)** For the general (non-Taylor) case and $n = 2m+1$, prove convergence for
$$
f_{-m:m}(Î¸) := âˆ‘_{k=-m}^m \hat f_k^n {\rm e}^{{\rm i} k Î¸}
$$
to $f(Î¸)$ as $n â†’ âˆž$.
What is the rate of convergence if we know that the first $Î»-1$ derivatives $f(Î¸), f'(Î¸), â€¦, f^{(Î»-1)}(Î¸)$
are 2Ï€-periodic and $f^{(Î»)}$ is uniformly bounded?

**SOLUTION**

Observe that by aliasing (see corollary in lecture notes) and triangle inequality we have the following
$$
|\hat f_k^n - \hat f_k|  â‰¤ âˆ‘_{p=1}^{âˆž} (|\hat f_{k+pn}|+|\hat f_{k-pn}|)
$$
Using the result from Problem 2 yields
$$
|\hat f_k^n - \hat f_k| â‰¤ \frac{C}{n^Î»} âˆ‘_{p=1}^{âˆž} \frac{1}{\left(p + \frac{k}{n}\right)^Î»} + \frac{1}{\left(p - \frac{k}{n}\right)^Î»}
$$
now we pick $|q| < \frac{1}{2}$ (such that the estimate below will hold for both summands above) and construct an integral with convex and monotonocally decreasing integrand such that
$$
\left( p + q \right)^{-Î»} < \int_{p-\frac{1}{2}}^{p+\frac{1}{2}} (x + q)^{-Î»} dx
$$
more over summing over the left-hand side from $1$ to $âˆž$ yields a bound by the integral:
$$
\int^{âˆž}_{\frac{1}{2}} (x + q)^{-Î»} dx = \frac{1}{Î»}(\frac{1}{2} + q)^{- Î» + 1}
$$
Finally let $q = \pm \frac{k}{n}$ to achieve the rate of convergence
$$
|\hat f_k^n - \hat f_k| â‰¤ \frac{C_{Î»}}{ n^{Î»}} \left(  \left( \frac{1}{2} + k/n \right)^{ - Î» + 1} + \left( \left( \frac{1}{2} - k/n \right) \right)^{- Î» +1} \right)
$$
where $C_{Î»}$ is a constant depending on $Î»$. Note that it is indeed important to split the $n$ coefficients equally over the negative and positive coefficients as stated in the notes, due to the estatime we used above.

Finally, we have:
$$
\begin{align*}
|f(Î¸) - f_{-m:m}(Î¸)|
&= |âˆ‘_{k=-m}^m {(\hat f_k - \hat f_k^n)z^k} + âˆ‘_{k=m+1}^âˆž {\hat f_k z^k}  + âˆ‘_{k=-âˆž}^{-m-1} {\hat f_k z^k} | \\
&\le âˆ‘_{k=-m}^m | \hat f_k - \hat f_k^n | + âˆ‘_{k=m+1}^âˆž |\hat f_k| +  âˆ‘_{k=-âˆž}^{-m-1} |\hat f_k| \\
&\le âˆ‘_{k=-m}^m {\frac{C_{Î»}}{ n^{Î»}} \left( \left( \frac{1}{2} + k/n \right)^{ - Î» + 1} + \left( \left( \frac{1}{2} - k/n \right) \right)^{- Î» +1} \right)} + âˆ‘_{k=m+1}^âˆž |\hat f_k| +  âˆ‘_{k=-âˆž}^{-m-1} |\hat f_k| \\
&= \frac{C_{Î»}}{n^{Î»}} 2^{Î»} + âˆ‘_{k=m+1}^âˆž |\hat f_k| +  âˆ‘_{k=-âˆž}^{-m-1} |\hat f_k|  \\
&= O(n^{-Î»}) + O(n^{1-Î»} ) + O(n^{1-Î»} ) \\
&= O(n^{1-Î»})
\end{align*}
$$

**END**

**Problem 3(c)** Show that $f_{-m:m}(Î¸)$ interpolates $f$ at $Î¸_j = 2Ï€j/n$ for $n = 2m+1$.

**SOLUTION**
Note from the aliasing property we have
$$
\meeq{
 \hat f_k^n {\rm e}^{{\rm i} k Î¸_j} =  \hat f_k^n {\rm e}^{2 Ï€ {\rm i} kj/n} = \hat f_{k+n}^n {\rm e}^{2 Ï€ {\rm i} (k+n) j/n} \ccr
 = \hat f_{k+n}^n  {\rm e}^{{\rm i} (k+n) Î¸_j}
}
$$
Thus we have
$$
\meeq{
f_{-m:m}(Î¸_j) = âˆ‘_{k=-m}^{-1} \hat f_k^n {\rm e}^{{\rm i} k Î¸_j} + âˆ‘_{k=0}^m \hat f_k^n {\rm e}^{{\rm i} k Î¸_j} \ccr
 = âˆ‘_{k=-m}^{-1} \hat f_{k+n}^n {\rm e}^{{\rm i} (k+n) Î¸_j} + âˆ‘_{k=0}^m \hat f_k^n {\rm e}^{{\rm i} k Î¸_j} \ccr
 = âˆ‘_{k=n-m}^{n-1} \hat f_{k}^n {\rm e}^{{\rm i} (k) Î¸_j} + âˆ‘_{k=0}^m \hat f_k^n {\rm e}^{{\rm i} k Î¸_j} = f_n(Î¸_j) = f(Î¸_j)
}
$$
**END**


**Problem 4(a)** Show for $0 â‰¤ k,â„“ â‰¤ n-1$
$$
{1 \over n} âˆ‘_{j=1}^n \cos k Î¸_j \cos â„“ Î¸_j = \begin{cases} 1 & k = â„“ = 0 \\
                                                  1/2 & k = â„“ \\
                                                  0 & \hbox{otherwise}
                                                  \end{cases}
$$
for $Î¸_j = Ï€(j-1/2)/n$. Hint: Be careful as the $Î¸_j$ differ from before,
and only cover half the period, $[0,Ï€]$. Using symmetry may help.
You may also consider replacing $\cos$ with
complex exponentials:
$$
\cos Î¸ = {{\rm e}^{{\rm i}Î¸} + {\rm e}^{-{\rm i}Î¸} \over 2}.
$$


**SOLUTION**
The case $k = l = 0$ is immediate. Otherwise, we have,
$$
\begin{align*}
\frac{1}{n}âˆ‘_{j=1}^n \cos(kÎ¸_j)\cos(lÎ¸_j) &= {1 \over 4n}âˆ‘_{j=1}^n \br[e^{i(k+l)Î¸_j} + e^{-i(k+l)Î¸_j} + e^{i(k-l)Î¸_j} + e^{-i(k-l)Î¸_j}].
\end{align*}
$$
For $Ï‰ = \exp(i Ï€/n)$ and any $m$ not a multiple of $2n$ we have
$$
\meeq{
âˆ‘_{j=1}^n e^{imÎ¸_j} =  âˆ‘_{j=0}^{n-1} e^{im Ï€(j+1/2)/n} = e^{i m Ï€/(2n)}  âˆ‘_{j=0}^{n-1} e^{i m Ï€ j/n} = Ï‰^{m/2} âˆ‘_{j=0}^{n-1} Ï‰^{m j} \ccr
 =  Ï‰^{m/2} {Ï‰^{nm} - 1 \over Ï‰^m - 1} =  Ï‰^{m/2} {(-1)^m - 1 \over Ï‰^m - 1}
}
$$
and hence
$$
\meeq{
âˆ‘_{j=1}^n [ e^{imÎ¸_j} +  e^{-imÎ¸_j}] = Ï‰^{m/2} {(-1)^m - 1 \over Ï‰^m - 1} + Ï‰^{-m/2} {(-1)^m - 1 \over Ï‰^{-m} - 1} \ccr
= Ï‰^{m/2} {(-1)^m - 1 \over Ï‰^m - 1} + Ï‰^{m/2} {(-1)^m - 1 \over 1 - Ï‰^m}  = 0.
}
$$
Since $0 < k+l â‰¤ 2n-2$ we know $k+l$ is not a multiple of $2n$ hence
$$
âˆ‘_{j=1}^n \br[e^{i(k+l)Î¸_j} + e^{-i(k+l)Î¸_j}] = 0.
$$
Now if $k = l$ we have
$$
âˆ‘_{j=1}^n e^{i(k-l)Î¸_j} = âˆ‘_{j=1}^n e^{-i(k-l)Î¸_j} = n.
$$
Otherwise $k-l â‰  0$ but also $1-n â‰¤ k-l â‰¤ n-1$ hence $k-l$ cannot be a multiple of $2n$. And thus
$$
âˆ‘_{j=1}^n \br[e^{i(k-l)Î¸_j} + e^{i(l-k)Î¸_j}] = 0.
$$

**END**


**Problem 4(b)** Consider the Discrete Cosine Transform (DCT)
$$
C_n := \begin{bmatrix}
\sqrt{1/n} \\
 & \sqrt{2/n} \\
 && â‹± \\
 &&& \sqrt{2/n}
 \end{bmatrix}
\begin{bmatrix}
    1 & â‹¯ & 1\\
    \cos Î¸_1 & â‹¯ & \cos Î¸_n \\
    â‹® & â‹± & â‹® \\
    \cos (n-1)Î¸_1 & â‹¯ & \cos (n-1)Î¸_n
\end{bmatrix}
$$
for $Î¸_j = Ï€(j-1/2)/n$. Prove that $C_n$ is orthogonal: $C_n^âŠ¤ C_n = C_n C_n^âŠ¤ = I$.

**SOLUTION**

The components of $C_n$ are
$$
ðž_k^âŠ¤ C_n  ðž_j =  {1 \over \sqrt{n}} \begin{cases} 1 & k = 1 \\ \sqrt{2} & k â‰  1 \end{cases} \cos((k-1)Î¸_j),
$$
where $Î¸_j = Ï€(j-1/2)/n$. We find using the previous part:
$$
\meeq{
ðž_k^âŠ¤ C_n C_n^âŠ¤ ðž_â„“  = \pr({\begin{cases} 1 & k = â„“ = 1 \\ \sqrt{2} & k,â„“ = 1, k â‰  â„“ \\
                                                    2 & k,â„“ â‰  1 \end{cases}})
     {1 \over n} âˆ‘_{j=1}^n \cos((k-1)Î¸_j) \cos((â„“-1)Î¸_j) \ccr
    = \pr({\begin{cases} 1 & k = â„“ = 1 \\ \sqrt{2} & k,â„“ = 1, k â‰  â„“ \\
                                                    2 & k,â„“ â‰  1 \end{cases}}) \pr({\begin{cases} 1 & k = â„“ = 1 \\
                                                  1/2 & k = â„“ \\
                                                  0 & \hbox{otherwise}
                                                  \end{cases}})= Î´_{k â„“}.
}
$$


**END**



**Problem 5** What polynomial interpolates $\cos z$ at $1, \exp(2Ï€\I/3)$ and $\exp(-2Ï€\I/3)$?

**SOLUTION**
For $Ï‰ =  \exp(2Ï€\I/3)$, we use the DFT:
$$
\meeq{
\Vectt[\hat f_0^3, \hat f_1^3, \hat f_2^3, \hat f_2^3] =
{1 \over 3} \begin{bmatrix}1 & 1 & 1  \\
                            1 &\exp(-2Ï€\I/3) & \exp(2Ï€\I/3) \\
                            1 & \exp(2Ï€\I/3)  & \exp(-2Ï€\I/3)
                            \end{bmatrix}
 \Vectt[\cos(1), \cos(\exp(2Ï€\I/3)), \cos(\exp(-2Ï€\I/3))] \ccr
 = {1 \over 3} \Vectt[\cos(1)+ \cos(\exp(2Ï€\I/3))+ \cos(\exp(-2Ï€\I/3)) ,
 \cos(1)+ \exp(-2Ï€\I/3) \cos(\exp(2Ï€\I/3))+ \exp(2Ï€\I/3) \cos(\exp(-2Ï€\I/3)) ,
 \cos(1)+ \exp(2Ï€\I/3) \cos(\exp(2Ï€\I/3))+ \exp(-2Ï€\I/3) \cos(\exp(-2Ï€\I/3))
 ]
}
$$
That is, the polynomial is
$$
\begin{align*}
&{\cos(1) + \cos(\exp(2Ï€\I/3))+ \cos(\exp(-2Ï€\I/3)) \over 3}  \cr
&+ {\cos(1)+ \exp(-2Ï€\I/3) \cos(\exp(2Ï€\I/3))+ \exp(2Ï€\I/3) \cos(\exp(-2Ï€\I/3))\over 3} z \cr
&+{\cos(1)+ \exp(2Ï€\I/3) \cos(\exp(2Ï€\I/3))+ \exp(-2Ï€\I/3) \cos(\exp(-2Ï€\I/3)) \over 3} z^2.
\end{align*}
$$
**END**