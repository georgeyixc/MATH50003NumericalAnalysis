# Fourier Expansions


Fourier series are a powerful tool in wide areas of mathematics, including solving partial differential equations, signal processing, and elsewhere.
They are also very useful in computational methods, particularly for problems that have periodicity. Periodicity arises naturally when solving
problems in radial coordinates, or when approximating a problem on the real line by a periodic problem with a large period.
Fourier series are also related to orthogonal polynomials, which can be used for non-periodic problems.




The most fundamental basis is (complex) Fourier: we have $\E^{\I k Î¸}$
are orthogonal with respect to the inner product
$$
âŸ¨f, g âŸ© := {1 \over 2Ï€} âˆ«_0^{2Ï€} \bar f(Î¸) g(Î¸) {\rm d}Î¸,
$$
where we conjugate the first argument to be consistent with the vector inner product $ğ±^â‹† ğ²$.
We will use the notation $ğ•‹ := [0,2Ï€)$ (typically this has the topology of a circle attached but
we do not need to worry about that here).
We can (typically) expand functions in this basis:

**Definition (Fourier)** A function $f$ has a Fourier expansion if
$$
f(Î¸) = âˆ‘_{k = -âˆ}^âˆ \hat f_k \E^{\I k Î¸}
$$
where
$$
\hat f_k := âŸ¨\E^{\I k Î¸}, fâŸ© = {1 \over 2Ï€} âˆ«_0^{2Ï€}  \E^{-\I k Î¸} f(Î¸) {\rm d}Î¸
$$
âˆ

A basic observation is if a Fourier expansion has no negative terms it is equivalent to a Taylor series in disguise:

**Definition (Fourier-Taylor)** A function $f$ has a Fourierâ€“Taylor expansion if
$$
f(Î¸) = âˆ‘_{k = 0}^âˆ \hat f_k \E^{\I k Î¸} = âˆ‘_{k = 0}^âˆ \hat f_k z^k
$$
where $\hat f_k := âŸ¨\E^{\I k Î¸}, fâŸ©$, and $z = \E^{\I Î¸}$.
âˆ


In numerical analysis we try to build on the analogy with linear algebra as much as possible.
Therefore we  can write this this as:
$$
f(Î¸) = \underbrace{[1 | \E^{\IÎ¸} | \E^{2\IÎ¸} | â‹¯]}_{T(Î¸)}
\underbrace{\begin{bmatrix} \hat f_0 \\ \hat f_1 \\ \hat f_2 \\ â‹® \end{bmatrix}}_{\vchatf}.
$$
Essentially, expansions in bases are viewed as a way of turning _functions_ into (infinite) _vectors_.
And (differential) _operators_ into _matrices_.


## Convergence of Fourier series

In analysis one typically works with continuous functions and relates results to continuity.
In numerical analysis we inherently have to work with _vectors_, so it is more natural
to  focus on the case where the _Fourier coefficients_ $\hat f_k$ are _absolutely convergent_:


**Definition (absolute convergent)** We write
$\vchatf âˆˆ â„“^1$ if it is absolutely convergent,
or in otherwords, the $1$-norm of $\vchatf$ is bounded:
$$
\|\vchatf\|_1 := âˆ‘_{k=-âˆ}^âˆ |\hat f_k| < âˆ.
$$
âˆ

We first state a  basic results (whose proof is beyond the scope of this module):

**Theorem (Fourier series equivalence)**
If $f, g : ğ•‹ â†’ â„‚$ are periodic and continuous and $\hat f_k = \hat g_k$ for all $k âˆˆ â„¤$ then $f = g$.

**Proof**
See [KÃ¶rner 2022 (Theorem 2.4)](https://www.cambridge.org/core/books/fourier-analysis/5FD8F0FD69DDB139019655D7F8440D2F).
âˆ

This allows us to prove the following:

**Theorem (Absolute converging Fourier series)**
If $\vchatf âˆˆ â„“^1$ then
$$
f(Î¸) = âˆ‘_{k = -âˆ}^âˆ \hat f_k \E^{\I k Î¸},
$$
which converges uniformly.
**Proof**

Note that
$$
g_n(Î¸) := âˆ‘_{k = -n}^n \hat f_k \E^{\I k Î¸}
$$
is uniformly-absolutely convergent as $n â†’ âˆ$, that is,
$$
âˆ‘_{k = -n}^n |\hat f_k \E^{\I k Î¸}| = âˆ‘_{k = -n}^n |\hat f_k| â†’ \|\vchatf\|_1.
$$
This guarantees that $g_n(Î¸)$ converges uniformly to a continuous function $g(Î¸)$. We have for $n > k$,
that the $k$-th Fourier coefficient of $g_n(Î¸)$ equals $\hat f_k$. Thus,
by the properties of uniform convergence,
$$
\hat f_k = \lim_{n â†’ âˆ} \hat f_k =  \lim_{n â†’ âˆ} {1 \over 2Ï€} âˆ«_0^{2Ï€}  \E^{-\I k Î¸} g_n(Î¸) {\rm d}Î¸ =
 {1 \over 2Ï€} âˆ«_0^{2Ï€}  \E^{-\I k Î¸} \lim_{n â†’ âˆ} g_n(Î¸) {\rm d}Î¸ = \hat g_k.
$$
Since $f$ and $g$ are continuous and share the same Fourier coefficients, they are equal.


âˆ


When does a function have absolutely convergent Fourier coefficients? We can deduce it from
periodic differentiability of the function:

**Lemma (differentiability and absolutely convergence)** If $f : ğ•‹ â†’ â„‚$ and $f'$ are periodic
 and $f''$ is uniformly bounded, then $\vchatf âˆˆ â„“^1$.

**Proof**
Integrate by parts twice using the fact that $f(0) = f(2Ï€)$, $f'(0) = f'(2Ï€)$:
$$
\begin{align*}
2Ï€\hat f_k &= âˆ«_0^{2Ï€} f(Î¸) \E^{-\I k Î¸} {\rm d}Î¸ =
[f(Î¸) {\E^{-\I k Î¸} \over -\I k}]_0^{2Ï€} + {1 \over \I k} âˆ«_0^{2Ï€} f'(Î¸) \E^{-\I k Î¸} {\rm d}Î¸ \\
&=  [f'(Î¸) {\E^{-\I k Î¸} \over (-\I k)^2 }]_0^{2Ï€} - {1 \over k^2} âˆ«_0^{2Ï€} f''(Î¸) \E^{-\I k Î¸} {\rm d}Î¸ \\
&= - {1 \over k^2} âˆ«_0^{2Ï€} f''(Î¸) \E^{-\I k Î¸} {\rm d}Î¸.
\end{align*}
$$
Thus uniform boundedness of $f''$ guarantees $|\hat f_k| â‰¤ M |k|^{-2}$ for some $M$, and we have
$$
âˆ‘_{k = -âˆ}^âˆ |\hat f_k| â‰¤ |\hat f_0|  + 2M âˆ‘_{k = 1}^âˆ |k|^{-2}  < âˆ
$$
using the dominant convergence test.

âˆ

This condition can be weakened to Lipschitz continuity but the proof is  beyond the scope
of this module.
Of more practical importance is the other direction: the more times differentiable a function the
faster the coefficients decay, and thence the faster Fourier expansions converge.
In fact, if a function is smooth and 2Ï€-periodic its Fourier coefficients decay
faster than algebraically: they decay like $O(k^{-Î»})$ for any $Î»$. This will be explored in the
problem sheet.



## Trapezium rule and discrete Fourier coefficients



**Definition (Periodic Trapezium Rule)** Let $Î¸_j = 2Ï€j/n$ for $j = 0,1,â€¦,n$ denote $n+1$ evenly spaced points over $[0,2Ï€]$.
Recall that the _Trapezium rule_ over $[0,2Ï€]$ is the approximation:
$$
âˆ«_0^{2Ï€} f(Î¸) {\rm d}Î¸ â‰ˆ {2 Ï€ \over n} \left[{f(0) \over 2} + âˆ‘_{j=1}^{n-1} f(Î¸_j) + {f(2 Ï€) \over 2} \right]
$$
But if $f$ is periodic we have $f(0) = f(2Ï€)$ and we get the _periodic Trapezium rule_:
$$
{1 \over 2Ï€} âˆ«_0^{2Ï€} f(Î¸) {\rm d}Î¸ â‰ˆ \underbrace{{1 \over n} âˆ‘_{j=0}^{n-1} f(Î¸_j)}_{Î£_n[f]}
$$
âˆ



We know that $\E^{\I k Î¸}$ are orthogonal with respect to the continuous inner product.
The following says that this property is maintained (up to â€œaliasing") when we replace the continuous
integral with a trapezium rule approximation:

**Lemma (Discrete orthogonality)**
We have:
$$
âˆ‘_{j=0}^{n-1} \E^{\I k Î¸_j} =
\begin{cases} n & k = \ldots,-2n,-n,0,n,2n,\ldots  \cr
              0 & \hbox{otherwise}
\end{cases}
$$
In other words,
$$
Î£_n[\E^{\I (k-â„“) Î¸}] =
\begin{cases} 1 & k-â„“ = \ldots,-2n,-n,0,n,2n,\ldots  \cr
              0 & \hbox{otherwise}
\end{cases}.
$$

**Proof**

Consider $Ï‰ := \E^{\I Î¸_1} = \E^{2 Ï€ \I \over n}$. This is an $n$-th root of unity: $Ï‰^n = 1$.
Note that $\E^{\I Î¸_j} =\E^{2 Ï€ \I j \over n}= Ï‰^j$.

(Case 1: $k = pn$ for an integer $p$)
We have
$$
âˆ‘_{j=0}^{n-1} \E^{\I k Î¸_j} = âˆ‘_{j=0}^{n-1} Ï‰^{kj} = âˆ‘_{j=0}^{n-1} ({Ï‰^{pn}})^j =   âˆ‘_{j=0}^{n-1} 1 = n
$$
(Case 2: $k â‰  pn$ for an integer $p$)  Recall that (via a telescoping sum argument)
$$
âˆ‘_{j=0}^{n-1} z^j = {z^n-1 \over z-1}.
$$
Then we have
$$
âˆ‘_{j=0}^{n-1} \E^{\I k Î¸_j} = âˆ‘_{j=0}^{n-1} (Ï‰^k)^j = {Ï‰^{kn} -1 \over Ï‰^k -1} = 0.
$$
where we use the fact that $k$ is not a multiple of $n$ to guarantee that $Ï‰^k â‰  1$.

âˆ

## Convergence of Approximate Fourier expansions

We will now use the Trapezium rule to approximate Fourier coefficients and expansions:

**Definition (Discrete Fourier coefficients)** Define the Trapezium rule approximation to the Fourier coefficients by:
$$
\hat f_k^n := Î£_n[\E^{-i k Î¸} f(Î¸)]  = {1 \over n} âˆ‘_{j=0}^{n-1} \E^{-i k Î¸_j} f(Î¸_j)
$$
âˆ

A remarkable fact is that the discete Fourier coefficients can be expressed as a sum of
the true Fourier coefficients:

**Theorem (discrete Fourier coefficients)**
If $\vchatf âˆˆ â„“^1$ (absolutely convergent Fourier coefficients) then
$$
\hat f_k^n = â‹¯ + \hat f_{k-2n} + \hat f_{k-n} + \hat f_k + \hat f_{k+n} + \hat f_{k+2n} + â‹¯
$$

**Proof**
$$
\begin{align*}
\hat f_k^n &= Î£_n[f(Î¸) \E^{-\I k Î¸}] = âˆ‘_{â„“=-âˆ}^âˆ \hat f_â„“ Î£_n[\E^{\I (â„“-k) Î¸}] \\
&= âˆ‘_{â„“=-âˆ}^âˆ \hat f_â„“ \begin{cases} 1 & â„“-k = \ldots,-2n,-n,0,n,2n,\ldots  \cr
0 & \hbox{otherwise}
\end{cases}
\end{align*}
$$
âˆ


**Example (Taylor coefficients via Geometric series)** Consider the function
$$
f(Î¸) = {2 \over 2 - \E^{\I Î¸}}
$$
Under the change of variables $z = \E^{\I Î¸}$ we know for
$z$ on the unit circle this becomes (using the geometric series with $z/2$)
$$
{2 \over 2-z} = âˆ‘_{k=0}^âˆ {z^k \over 2^k}
$$
i.e., $\hat f_k = 1/2^k$ which is absolutely summable:
$$
âˆ‘_{k=0}^âˆ |\hat f_k| = f(0) = 2.
$$
If we use an $n$ point discretisation we get for $0 â‰¤ k â‰¤ n-1$ (using the geoemtric series with $2^{-n}$)
$$
\hat f_k^n = \hat f_k + \hat f_{k+n} + \hat f_{k+n} + â‹¯ = âˆ‘_{p=0}^âˆ {1 \over 2^{k+pn}} = {2^{n-k} \over 2^n - 1}
$$
Note that as $n \rightarrow âˆ$, we have $\hat f_k^n \rightarrow \hat f_k$.
âˆ




Note that there is redundancy:

**Corollary (aliasing)**
For all $p âˆˆ â„¤$, $\hat f_k^n = \hat f_{k+pn}^n$.

**Proof**
Follows immediately:
$$
\hat f_{k+pn}^n = \sum_{j=-âˆ}^âˆ \hat f_{k+(p+j)n}= \sum_{j=-âˆ}^âˆ \hat f_{k+j n} = \hat f_k^n.
$$
âˆ


In other words if we know $\hat f_0^n, â€¦, \hat f_{n-1}^n$, we know $\hat f_k^n$ for all $k$ via a permutation,
for example if $n = 2m+1$ we have
$$
\begin{bmatrix}
\hat f_{-m}^n \\
â‹®\\
\hat f_{-1}^n \\
\hat f_0^n \\
â‹®\\
\hat f_m^n
\end{bmatrix} = \underbrace{\begin{bmatrix} &&& 1 \\ &&&& â‹± \\ &&&&& 1 \\
    1 \\ & â‹± \\ && 1 \end{bmatrix}}_{P_Ïƒ}
\begin{bmatrix}
\hat f_0^n \\
â‹®\\
\hat f_m^n\\
\hat f_{m+1}^n \\
â‹®\\
\hat f_{n-1}^n
\end{bmatrix}
$$
where $Ïƒ$ has Cauchy notation (_Careful_: we are using 1-based indexing here):
$$
\begin{pmatrix}
1 & 2 & â‹¯ & m & m+1 & m+2 & â‹¯ & n  \\
m+2 & m+3 & â‹¯ & n & 1 & 2 & â‹¯ & m+1
\end{pmatrix}.
$$




We can  prove _convergence_ whenever $f$ has absolutely summable coefficients.
We will prove the result here in the special case where the negative
coefficients are zero. That is, $\hat f_0^n, â€¦, \hat f_{n-1}^n$ are approximations of the Fourierâ€“Taylor coefficients.


**Theorem (Approximate Fourier-Taylor expansions converge)**
If $0 = \hat f_{-1} = \hat f_{-2} = â‹¯$ and $\vchatf$ is absolutely convergent then
$$
f_n(Î¸) = âˆ‘_{k=0}^{n-1} \hat f_k^n \E^{\I k Î¸}
$$
converges uniformly to $f(Î¸)$.

**Proof**

$$
\begin{align*}
|f(Î¸) - f_n(Î¸)| = |âˆ‘_{k=0}^{n-1} (\hat f_k - \hat f_k^n) \E^{\I k Î¸} + âˆ‘_{k=n}^âˆ \hat f_k \E^{\I k Î¸}|
= |âˆ‘_{k=n}^âˆ \hat f_k (\E^{\I k Î¸} - \E^{\I {\rm mod}(k,n) Î¸})|
â‰¤ 2 âˆ‘_{k=n}^âˆ |\hat f_k|
\end{align*}
$$
which goes to zero as $n â†’ âˆ$.
âˆ

For the general case we need to choose a range of coefficients that includes roughly an equal number of
negative and positive coefficients (preferring negative over positive in a tie as a convention):
$$
f_n(Î¸) = âˆ‘_{k=-âŒˆn/2âŒ‰}^{âŒŠn/2âŒ‹} \hat f_k \E^{\I k Î¸}
$$
In the problem sheet we will prove this converges provided the coefficients are absolutely convergent.





